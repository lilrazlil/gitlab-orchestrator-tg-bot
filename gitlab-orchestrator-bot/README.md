# Telegram Chatbot на Go

Этот проект представляет собой Telegram чат-бота, написанного на Go, который используется в качестве интерфейса для управления демо-диспетчером. Бот взаимодействует с бэкендом для выполнения различных операций, таких как создание стендов, управление пользователями и отправка уведомлений.

## Функциональность

- **Авторизация пользователей и администраторов**: Бот проверяет роли пользователей (администратор или пользователь) перед выполнением действий.
- **Создание стендов**: Пользователи могут создавать стенды, выбирая продукты из списка.
- **Управление уведомлениями**: Бот отправляет уведомления о статусе выполнения задач.
- **Кастомизация через переменные окружения**: Настройки бота, такие как токен и URL бэкенда, задаются через переменные окружения.

## Требования

- **Go 1.21** или выше
- **Telegram Bot API Token** (получить у [BotFather](https://core.telegram.org/bots#botfather))
- **Backend API** (URL бэкенда для взаимодействия)

## Установка

1. Убедитесь, что у вас установлен Go версии 1.21 или выше.
2. Склонируйте репозиторий:
   ```bash
   git clone <URL репозитория>
   cd gitlab-orchestrator-bot
   ```
3. Установите зависимости:
   ```bash
   go mod tidy
   ```

## Настройка

Перед запуском бота необходимо задать переменные окружения:

| Переменная     | Описание                                                                            | Обязательность |
|----------------|------------------------------------------------------------------------------------|----------------|
| **TOKEN**      | Токен чат-бота, полученный от [BotFather](https://core.telegram.org/bots#botfather) | Да             |
| **BACKEND_URL**| URL для подключения к API бэкенда (например, http://localhost:8080/api/v1)          | Да             |

## Запуск

1. Убедитесь, что переменные окружения заданы.
2. Запустите бота:
   ```bash
   go run main.go
   ```

## Структура проекта

- **`auth/`**: Логика авторизации пользователей и администраторов.
- **`client/`**: Взаимодействие с API бэкенда (получение данных, отправка запросов).
- **`config/`**: Конфигурация бота, включая глобальные переменные и настройки.
- **`internal/`**: Основная бизнес-логика, включая обработку уведомлений и вспомогательные функции.
- **`telegram/`**: Логика работы с Telegram Bot API (обработчики, кнопки, мидлвари).
- **`main.go`**: Точка входа в приложение.

## Основные файлы

- **`main.go`**: Инициализация конфигурации, авторизации, бота и запуск обработчиков.
- **`auth/authorized.go`**: Загрузка пользователей и их ролей из бэкенда.
- **`client/client.go`**: Реализация HTTP-запросов к бэкенду.
- **`config/config.go`**: Настройка переменных окружения и глобальных переменных.
- **`telegram/handlers/handlers.go`**: Обработчики команд и взаимодействий с пользователем.
- **`telegram/middlewares/middlewares.go`**: Мидлвари для проверки авторизации и логирования.

## Основные команды

- **`/createstand`**: Начало процесса создания стенда. Пользователь вводит название стенда, выбирает продукты и подтверждает создание.

## Пример использования

1. Пользователь отправляет команду `/createstand`.
2. Бот запрашивает название стенда.
3. Пользователь вводит название, бот предлагает выбрать продукты.
4. После выбора продуктов пользователь подтверждает создание стенда.
5. Бот отправляет запрос на бэкенд для создания стенда.

## Логирование

Бот ведет логирование всех действий пользователей, включая команды, нажатия кнопок и текстовые сообщения. Логи можно использовать для отладки и мониторинга.

## Кастомизация

- **Название домена**: Можно изменить в `config/config.go` (переменная `Domain`).
- **Количество столбцов в клавиатуре продуктов**: Настраивается через `NumberOfLinesSubos`.

## Лицензия

Этот проект распространяется под свободной лицензией. Используйте его на свой страх и риск.
```